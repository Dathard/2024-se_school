#!/usr/bin/env php
<?php
require __DIR__ . '/../app/bootstrap.php';

if ('cli' !== PHP_SAPI) {
    throw new \Exception('bin/* must be run as a CLI application');
}

unset($argv[0]);

$objectManager = new \Core\ObjectManager();
$commandName = array_shift($argv);
/** @var \Core\Cli\CommandInterface $command */
$command = $objectManager->get("Core\\Cli\\Command\\".ucfirst($commandName));

if (! $command) {
    throw new \Exception('The command is not valid. Please check it and try again.');
}

/** @var \Core\Cli\ParamsParser $paramsParser */
$paramsParser = $objectManager->get(\Core\Cli\ParamsParser::class);
$params = $paramsParser->execute($argv);

$command->execute($params);